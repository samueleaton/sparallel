'use strict';var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&'function'==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}function isArray(a){return!!a&&'object'==('undefined'==typeof a?'undefined':_typeof(a))&&(Array.isArray&&Array.isArray(a)||a.constructor===Array||a instanceof Array)}function forOwn(a,b){for(var c in a)a.hasOwnProperty(c)&&'function'==typeof b&&b(a[c],c)}function isObject(a){var b='undefined'==typeof a?'undefined':_typeof(a);return!!a&&('object'===b||'function'===b)}function forEach(a,b){if(!a||!a.length)return null;if('function'!=typeof b)return console.error('2nd param to forEach must be function');for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function flatten(a){var b=[];return forEach(a,function(c){isArray(c)?forEach(c,function(d){return b.push(d)}):b.push(c)}),b}function sparallel(){for(var _len=arguments.length,a=Array(_len),_key=0;_key<_len;_key++)a[_key]=arguments[_key];var b=function(){function b(){_classCallCheck(this,b);for(var _len2=arguments.length,c=Array(_len2),_key2=0;_key2<_len2;_key2++)c[_key2]=arguments[_key2];this.total=c.length,this.counter=0,this.functions=c,this.doneObj={}}return _createClass(b,[{key:'functionDone',value:function functionDone(c){var _this=this;return this.counter++,isObject(c)&&forOwn(c,function(d,e){_this.doneObj[e]=d}),this.counter===this.total&&('function'==typeof setImmediate?setImmediate(function(){return _this.runCb(_this.doneObj)}):setTimeout(function(){return _this.runCb(_this.doneObj)},0)),c}},{key:'run',value:function run(c,d){var _this2=this;this.runCb=c,forEach(this.functions,function(e){e(function(){var f=!1,g=function(h){if(!f)return f=!0,_this2.functionDone(h)};// this is what's passed to each function
return function(h){return g(h)}}(),d)})}}]),b}();return new Promise(function(c,d){new(Function.prototype.bind.apply(b,[null].concat(_toConsumableArray(flatten(a)))))().run(c,d)})}module.exports=sparallel;